<%- include ../../partials/nav %>
<%- include ../../partials/household_top %>

<div class="body-content">
    <div class="content-bottom">
        <form action="/household/messages" method="POST" enctype="multipart/form-data">
            <input type="text" name="title" placeholder="title">
            <input type="text" name="content" placeholder="content">
            <div><i class="far fa-caret-square-down fa-3x"></i></div>
            <input type="file" name="image">
            <input type="submit" value="post" id="submitbtn">
        </form>
    </div>
    <div id="notification">
            <h2>New message posted!</h2>
        </div>
    <div class="content">
            <a href="/household">
                <i class="fas fa-arrow-left fa-3x"></i>
            </a>
    <% if (messages.length > 0) {
        messages.sort(function (a,b){
            if(a.updatedAt > b.updatedAt) return -1;
            else if(a.updatedAt < b.updatedAt) return 1;
            else return 0;
        })
        messages.forEach(function(m) { %>
        <div class="one-msg">
            <h3><%= m.author %></h3>
            <h2><%= m.title %></h2>
            <p><%= m.content %></p>
            <% if (m.picture) {%>
                <img src="<%=m.picture%>" alt="pic">
            <%}%>
            <form action="/household/messages/<%=m._id%>?_method=DELETE" method="POST">
                <button type="submit" value="delete" class="deletebtn">delete</button>
            </form>
        </div>
         <%})
    } else { %>
    <p>no messages yet</p>
    <%}%>
    <!-- <form action="/api/images" method="POST" enctype="multipart/form-data">
        <input type="file" name="image">
        <input type="submit" value="post image">
    </form> -->

</div>
</div>

<script src="/socket.io/socket.io.js"></script>
<script src="/javascripts/messages.js"></script>
</div>
<%- include ../../partials/footer %>